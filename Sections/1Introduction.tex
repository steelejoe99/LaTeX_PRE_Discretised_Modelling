% !TeX root = ../main.tex
\section{Introduction}
\label{sec:introduction}
%
Semiconductor lasers are fundamental components in modern photonic technologies.
Their emission wavelengths align with those used in optical communication networks, making them valuable light sources. 
In addition, they are orders of magnitude smaller than typical helium–neon lasers, with coherence lengths of only a few millimetres compared to many metres, which enables widespread practical applications \cite{heiskanen2018photobiomodulation}.
Semiconductor lasers are not only smaller than conventional gas lasers, but also exhibit much higher output coupling, with approximately 70\% of the light intensity escaping them compared to 1-5\% for gas lasers \cite{vantartwijk1995semiconductor}.
However, this openness makes semiconductor lasers more susceptible to external disturbances, leading to a strong response to incident signals.
Although undesirable in practical applications, this sensitivity has made semiconductor lasers a central platform for investigating nonlinear dynamics induced by external optical feedback.
The influence of external light on laser operation has been extensively investigated since the 1970s, with particular focus on conventional optical feedback (COF), typically achieved by reflecting output laser light back into the laser cavity using a mirror, as well as on optical injection of laser light from another laser \cite{weiss1991dynamics}.
Feedback and injection mechanisms have important practical implications: for example, the former arises in the operation of CD players, while the latter is central to laser amplification systems.
Beyond their direct historical significance, semiconductor lasers with feedback underpin key technologies in modern photonics. 
Feedback control is exploited to stabilize frequency and linewidth in coherent optical communication \cite{tkach2003regimes}, to enhance sensitivity in precision sensing and metrology, and to enable secure chaos-based encryption schemes \cite{uchida2008fast}. 
At the same time, semiconductor lasers with feedback provide a prototypical and experimentally accessible example of delay differential equations (DDEs), serving as a testbed for nonlinear dynamics with relevance extending to control theory \cite{stepan1989retarded}, electronics, and biological systems \cite{mackey1977oscillation}.
%
%
\subsection{Lang-Kobayashi equations}
A major breakthrough occurred in 1980 with the seminal work of Lang and Kobayashi, who introduced the Lang–Kobayashi (LK) rate equations to describe the dynamics of a semiconductor laser subject to COF from a distant external mirror \cite{lang1980external}.
The LK equations describe the time evolution of the complex electric field $E = E_x + iE_y$ and the carrier inversion $N$ under the influence of external feedback $F(t)$.
A nondimensionalized form of these equations, highlighting the key parameters governing the system dynamics, is given by \eqref{eq:LK} \cite{heil2003delay}
%
\begin{equation}
\label{eq:LK}
    \begin{aligned}
        \frac{d E}{d t} & =(1+i \a) N(t) E(t)+\eta F(t) \\
        T \frac{d N}{d t} & =P-N(t)-(1+2 N(t))|E(t)|^2
    \end{aligned}
\end{equation}
%
where $F(t) = e^{-i\wZ\tau} E(t-\tau)$. 
These key parameters can be separated into intrinsic laser parameters and external cavity (EC) parameters. 
The laser, emitting at a single frequency $\w_0$, is characterised by the pump current $P$, the linewidth enhancement factor $\a$, and the ratio of photon and electron decay times $T = \tau_e/\tau_p$. 
The EC is characterised by the round-trip delay time $\tau = 2L_\text{EC}/c$, the feedback power level (defined as the ratio of power reflected from the external mirror to that from the diode mirror) $\eta$, and the feedback phase $C_p = \w_0 \tau$, corresponding to the number of optical wavelengths in the EC.
The application of these equations requires a single-mode laser subject to weak feedback (up to a few percent of the emitted light) from a long EC ($\mathcal{O}(\text{cm})$–$\mathcal{O}(\text{m})$). 
As the LK equations assume single-mode operation, they do not capture mode competition or spectral dynamics; for approaches to the analysis of multimode lasers, see \cite{yacomotti2004dynamics} and references therein.
A long EC justifies treating the feedback phase $C_p$ as an independent parameter from the delay $\tau$, since a $2\pi$ phase shift corresponds to only a half-wavelength change (about one micron), which is negligible at these scales \cite{green2006mode}. 
In practice, varying $C_p$ over a full $2\pi$ is achieved by shifting the mirror position by less than a micron for visible wavelengths, for example using a piezoelectric transducer \cite{heil2003delay}.
It is noted that, these equations are formulated with reference to the centre frequency of the laser, with $\wZ = 0$ at the operating frequency, which implies $C_p = 0$ in the first instance. 
The weak-feedback condition further ensures that multiple EC reflections between the laser facet and the external mirror can be neglected; if this condition is not satisfied, the feedback $F(t)$ takes a more complex form \cite{vantartwijk1995semiconductor}.
%
\begin{equation}
\label{eq:multiple_EC}
    F(t) = \frac{r_2^{\;2} - 1}{r_2^{\;2}} \sum_{n=1}^\infty (-r_2 r)^n e^{-i n C_p} E(t-n \tau)
\end{equation}
%
\par
%
The LK equations successfully capture the rich dynamical behaviour of semiconductor lasers under weak external feedback, including steady-state, periodic, quasi-periodic, and chaotic emission, as well as complex behaviours such as regular pulse packages (RPPs), coherence collapse (CC), and low-frequency fluctuations (LFFs) \cite{heil1998coexistence}.
The delay $E(t-\tau)$ present in the feedback term $F(t)$ makes the LK equations DDEs with phase space in the infinite-dimensional Banach space $C([-\tau,0],\mathbb{C}\times\mathbb{R})$, consisting of continuous functions that describe the past history of the optical field.
Due to the rotational symmetry of the complex field $E$, the effective phase space is this function space modulo the action of $\mathrm{S}^1$.
This memory effect, arising from time-delayed optical feedback whereby the system evolves according to both its current and past states, is absent in injected semiconductor laser systems, where dynamics are instead dominated by phase-locking and frequency pulling \cite{wieczorek1999unifying,wieczorek2005dynamical}.
The impact of the LK equations stems from their role as a minimal yet sufficient model: a coupled nonlinear DDE system that reproduces experimentally observed behaviours while remaining amenable to rigorous analysis.
In this framework, equilibria can be analysed in detail, including their creation and annihilation via saddle-node bifurcations and their loss of stability through Hopf bifurcations, yielding a clear picture of local dynamics \cite{rottschafer2007ecm}.
Moreover, numerical continuation tools for DDEs, such as \texttt{DDE-Biftool}, enable systematic tracking of equilibria and periodic orbits, as well as the detection of secondary bifurcations that organise the global dynamics \cite{sieber2014dde, krauskopf2004dynamics}.
%
\par
%
A central insight of the LK model is the structure of its steady states, known as external cavity modes (ECMs).
The ECMs form an ellipse in frequency space centred at the free-running laser frequency, with the maximum gain mode (MGM) located on the outer boundary, farthest from the centre frequency.
The number of ECMs and the frequency interval they occupy increase with feedback strength and external cavity length. 
ECMs are typically created in saddle-node pairs as parameters vary, and their stability changes through Hopf bifurcations \cite{heil2003delay, rottschafer2007ecm}.
The set of ECMs provides the backbone of the LK dynamics: it organises transients and families of periodic and quasi-periodic motions that arise from Hopf and subsequent bifurcations.
In regimes such as LFFs and CC, trajectories spend long intervals near weakly stable ECMs before departing along unstable manifolds of neighbouring saddle ECMs, producing intensity dropouts; the prevalence and severity of these behaviours increase with the size of the ECM ellipse \cite{heil2003delay, krauskopf2004dynamics}.
Thus, understanding the geometry, multiplicity, and stability of ECMs is essential for explaining observed dynamical regimes and for devising control strategies.
This perspective naturally motivates efforts to reduce or confine the set of accessible ECMs, thereby enhancing stability under stronger feedback by limiting the number of available steady-states.
A crucial step in this direction is understanding how different forms of feedback, beyond conventional optical feedback, can suppress or restructure the ECM ellipse, providing new routes to controlled laser dynamics.
%
%
\subsection*{Phase-conjugate feedback}
\label{subsec:PCF}
%
A single-mode semiconductor laser with phase-conjugate feedback (PCF) receives wavefront-inverted light from a phase-conjugating mirror (PCM), typically realised by degenerate four-wave mixing in vapours or semiconductors or by gratings and optical crystals, creating a self-aligning configuration that compensates EC distortions.
By reversing wavefront errors on each round trip, phase conjugation stabilises both beam quality and frequency, motivating its application in semiconductor lasers.
Owing to these potential stabilisation features, PCF was among the earliest feedback configurations investigated beyond COF \cite{krauskopf1998semiconductor, green2004bifurcation}.
In the standard LK rate-equation framework \eqref{eq:LK}, PCF is represented by a delayed conjugated field term, $F(t) = e^{-i \phi_\text{PCM}} E^*(t-\tau)$, which yields a DDE system with discrete $\mathbb{Z}_2$ symmetry $E \rightarrow -E$ \cite{krauskopf2002routes}.
This symmetry leads to qualitative differences in the mode structure: whereas COF produces a continuous ellipse of ECMs organised by the feedback phase, PCF gives rise instead to isolated branches of pulsating ECMs whose frequencies are locked near integer multiples of the cavity frequency \cite{erneux2003external}.
Within the locking range, the PCF laser is both frequency- and phase-locked to the pump, and, unlike COF, phase locking does not depend on the feedback phase.
Overall, the resulting linewidth is ultranarrow and robust against added noise \cite{green2002global}.
%`'
%
\subsection*{Filtered optical feedback}
\label{subsec:FOF}
%
The most direct method of controlling the ECMs in a semiconductor laser is to filter the light fed back into the cavity, a scheme known as filtered optical feedback (FOF). 
By modifying the spectrum of the reinjected light, FOF reshapes the set of accessible ECMs.
Several practical implementations of FOF have been investigated. One approach is the insertion of a Fabry–Pérot resonator within the feedback loop \cite{detienne1997semiconductor}. More commonly, the external mirror is replaced by a frequency-selective surface, such as a grating \cite{dahmani1987frequency, harvey1991external, jin1996single}, or by a phase-conjugating surface, for example a Kerr-type nonlinear medium, which in this context acts primarily as a spectral filter \cite{agrawal1984line}.
As expected, all of these implementations lead to significant linewidth narrowing, resulting in more stable operation around the filter’s free-running frequency.
This makes FOF a practical approach for stabilising single-mode operation and narrowing emission spectra in photonic applications.
%
\par
%
Mathematical analysis of FOF poses additional challenges. 
In this case, the spectral components of the electric field must be included explicitly, since their reflection is governed by the frequency response of the chosen filter, denoted $\rho(\w)$.
Therefore, the feedback term $F(t)$ must be replaced by a more general expression that accounts for this frequency selectivity.
For a given reflection response, $F(t)$ can be obtained by decomposing the field into its Fourier components, applying the filter’s reflectivity spectrum $\rho(\w)$, and then taking the inverse Fourier transform \cite{yousefi1999dynamical}.
Mathematically, this amounts to
%
\begin{equation}
    \begin{aligned}
    \label{eq:FOF}
         F(t) &=  \mathcal{F}^{-1}\big[ \mathcal{F}[E(t)](\w) \times \rho(\w) \big](t-\tau)\\
              &= \frac{1}{2\pi} \int_{-\infty}^{\infty} \rho(\w) \int_{-\infty}^{\infty} E(t') e^{-i \w t'} dt' e^{i \w (t-\tau)} d\w.
    \end{aligned}
\end{equation}
%
This expression highlights that the feedback is no longer a simple delayed replica of the field, but a spectrally filtered version shaped by $\rho(\w)$.
Unlike COF and PCF, FOF directly reshapes the spectral window of accessible ECMs.
Note that \eqref{eq:FOF} again assumes a single reflection is sufficient to describe the external feedback signal $\eta F(t)$.
he distributed nature of the feedback expressed in \eqref{eq:FOF} makes the system difficult to treat analytically and computationally demanding to simulate.
The modified LK equations take the form of integro-differential equations that are not amenable to standard bifurcation analysis tools, such as fixed-point calculation and stability analysis, which obscures even basic insights into the influence of filtering on the system.
Furthermore, numerical methods such as direct time-series integration of $(E,N)$ become significantly more computationally demanding, since \eqref{eq:FOF} must be re-evaluated at every time step through numerical integration, rather than simply retrieving the stored value $E(t-\tau)$ as in the standard LK equations.
%
\par
%
A key insight was provided in 1999 by Yousefi and Lenstra \cite{yousefi1999dynamical}, who assumed that filtering yields a frequency-dependent reflectivity spectrum $\rho(\w)$ represented as a sum of Lorentzians.
By considering a single Lorentzian, which can adequately describe certain external feedback mechanisms \cite{dahmani1987frequency,detienne1997semiconductor}, they showed that the integro-differential equations for distributed FOF can be reduced to a system of DDEs.
In this formulation, the first two equations remain identical to the standard LK system, while the effect of filtering is incorporated by coupling an additional equation for $F(t)$.
%
\begin{equation}
\label{eq:FOF_LK}
    \frac{d F}{d t} = \Lambda E(t-\tau) e^{-i C_p}+(i \Delta-\Lambda) F(t)
\end{equation}
%
Here, $\Lambda$ is the full width at half maximum (FWHM) of the filter, which sets its spectral width, and $\Delta$ is the detuning of the Lorentzian filter from the laser’s free-running frequency.
Since coupling \eqref{eq:FOF_LK} to the standard LK equations \eqref{eq:LK} again yields a system of DDEs, the model remains amenable to the same analytical and numerical methods as the original LK system.
They demonstrated that, as expected, the system generally admits fewer ECMs than COF and that, overall, filtering leads to more stable dynamics.
Alongside the reduction in the number of accessible ECMs, the MGM tends to lie closer to the filter frequency (though not exactly at it) rather than at the edge of the fixed-point ellipse as in COF.
Overall, the formulation of these equations as coupled DDEs allows for detailed investigation through continuation and stability analysis of the stationary states, providing deeper insight into the influence of FOF on semiconductor lasers 
\cite{erzgraber2006frequency, erzgraber2007bifurcation, erzgraber2007dynamics, fischer2000experimental, fischer2004experimental, green2006mode, 
hek2007semiconductor, erzgraber2007feedback, fischer2004filtered, yousefi2001global, yousefi2002simulations, yousefi2003nonlinear}. 
%
%
\subsection*{Fiber Bragg grating feedback}
\label{subsec:FBG_LK}
%
\subsubsection*{Fiber Bragg gratings}
\label{subsubsec:FBG}
%
One frequency-selective component that has been the focus of extensive research in recent decades is the fiber Bragg grating (FBG).
FBGs offer several advantages over other fibre-optic technologies.
These include all-fibre design, low insertion loss, high return loss, potential for lower cost, and, most notably, exceptional flexibility in tailoring spectral characteristics.
With current manufacturing techniques, gratings can be fabricated with nearly arbitrary spectral responses $\rho_\text{Bragg}(\w)$ and normalised bandwidths ranging from $10^{-4}$ to $0.1$ \cite{erdogan1997fiber}.
The FBG is therefore a natural reflective element for implementing FOF.
%
\begin{figure}
    \centering 
    \includegraphics[width=\linewidth]{Images/FBG_setup_dneff_only_1col.pdf}
    \caption{Sketch of an optical fiber with an FBG written along its length.}
    \label{fig:FBG_setup}
\end{figure}
%
\par
%
An FBG is defined as a periodic modulation $\delta n_{eff}(z)$ of the refractive index with period $\Lambda$ along a fibre of length $L_\text{FBG}$.
The number of gratings in an FBG is therefore $N = L_\text{FBG}/\Lambda$. The most general form of this periodic modulation is
%
\begin{equation}
\label{eq:dneff}
    \delta n_{eff}(z) = \dnbar(z) \left[ 1 + v \cos{\left( \frac{2 \pi}{\Lambda} z + \phi(z) \right)} \right].
\end{equation}
%
Here, $\dnbar(z)$ describes the envelope of the periodic modulation along $L_\text{FBG}$; for example, $\dnbar(z) \sim e^{-z^2}$ yields a Gaussian refractive index profile. 
This flexibility allows tailoring of the spectral response through modulation depth and phase, directly influencing the accessible ECM structure.
In addition to the envelope, $v$ denotes the fringe visibility of the index modulation, and $\phi(z)$ allows variation of the grating period along the fibre, enabling different frequencies to be reflected at different positions.
%
\par
%
Light propagating in the fibre and interacting with the FBG undergoes diffraction when its wavelength is close to the design wavelength, $\lambda_D = 2 n_{\text{eff}} \Lambda$.
It is typically assumed that the light undergoes only first-order diffraction, which dominates in FBGs, so that a single propagating mode is considered; higher-order diffraction is negligible under standard design conditions.
In this case, using coupled-mode theory and the synchronous approximation, one can derive coupled first-order differential equations describing the interaction between the forward- and backward-propagating waves, $A(z)$ and $B(z)$, respectively.
For further details, see \cite{erdogan1997fiber} and references therein.
%
\begin{equation}
\label{eq:wave_eqs}
    \begin{aligned}
        \frac{dR}{dz} &= i \hat{\sigma} R(z) + i \k S(z), \\
        -\frac{dS}{dz} &= i \hat{\sigma} S(z) + i \k R(z),
    \end{aligned}
\end{equation}
%
with $R(z) = A(z) \exp{ \left( -i \left( \phi/2 -\delta z \right) \right) }, \; S(z) = B(z) \exp{ \left( -i \left( \phi/2 + \delta z \right) \right) }$.
The parameters $\delta$, the wavevector mismatch, $\kappa$, the alternating-current (AC) coupling coefficient, and $\hat{\sigma}$, the direct-current (DC) self-coupling coefficient, are given by
%
\begin{align}
    \label{eq:delta}
    \delta &= 2 \pi \neff \left( \frac{1}{\lambda} - \frac{1}{\lambda_D} \right) \\
    \label{eq:kappa}
    \k &= \frac{\pi}{\lambda} v \dnbar(z)\\
    \label{eq:sigma}
    \hat{\sigma} &= \frac{2\k}{v} + \delta -\frac{1}{2}\frac{d\phi}{dz}
\end{align}
%
Since $\k$ and $\hat{\sigma}$ generally depend on $z$, \eqref{eq:wave_eqs} cannot in general be solved analytically, but they can be readily solved numerically once $\Lambda$, $n_{\text{eff}}$, $\dnbar(z)$, $\phi(z)$, and $L_\text{FBG}$ are specified.
%
\par
%
At this point, all the necessary ingredients are in place to calculate the key characteristic of an FBG—its reflectivity spectrum $\rho(\w)$.
Physically, the primary interest lies in the reflection spectrum of light reflected at the front FBG interface, assuming no reflection from the back interface.
Therefore, \eqref{eq:wave_eqs} is typically solved by setting $z = 0$ at the midpoint of the FBG, imposing boundary conditions $R(-L_\text{FBG}/2) = 1$ and $S(L_\text{FBG}/2) = 0$, and integrating backwards from $L_\text{FBG}/2$ to $-L_\text{FBG}/2$. The amplitude reflection coefficient is then given by
%
\begin{equation}
\label{eq:rho}
    \rho = \frac{S(-L_\text{FBG}/2)}{R(-L_\text{FBG}/2)}
\end{equation}
%
which defines the reflectivity spectrum $\rho(\omega)$.
Although \eqref{eq:wave_eqs} must generally be solved numerically and closed-form expressions for $\rho(\omega)$ are rarely available, certain standard grating designs such as uniform or raised-cosine-apodised gratings admit analytic solutions and provide valuable insight into the typical properties of FBG reflection spectra.
Among the different grating profiles, the simplest and most widely studied is the uniform grating.
%
%
\subsubsection*{Uniform FBG reflection spectra $\rho_\text{Bragg}(\w)$}
\label{subsubsec:FBG_feedback}
%
The uniform FBG serves as the canonical case for analysis, characterised by constant period and constant modulation depth.
It admits analytic solutions that not only reveal the fundamental characteristics of FBG reflection spectra but also serve as a reference for more complex grating designs.
In this case, the grating chirp satisfies $\sfrac{d\phi}{dz} = 0$ and the apodisation is constant, $\dnbar = \text{const.}$, so that the grating index variation given by \eqref{eq:dneff} reduces to a sine wave, as shown in Figure~\ref{fig:FBG_setup}.
Therefore, $\k$ and $\hat{\sigma}$ are constant in $z$, which allows the reflectivity spectrum $\rho(\omega)$ to be obtained analytically by solving \eqref{eq:wave_eqs} and then evaluating \eqref{eq:rho}.
%
\begin{equation}
\label{eq:uniform_rho}
    \rho = \frac{-\k \sinh\left( L_\text{FBG}\right)}{\hat{\sigma} \sinh\left(\gamma L_\text{FBG}\right) + i\gamma \cosh\left(\gamma L_\text{FBG}\right)}
\end{equation}
%
where $\gamma = \sqrt{\k^2 - \hat{\sigma}^2}$. Several key features of the reflection spectrum $\rho(\omega)$ are most clearly visualised by plotting it as a function of normalised frequency while varying $\kappa L_\text{FBG}$ for a fixed $N$ \cite{erdogan1997fiber}.
%
\begin{equation*}
    \frac{\omega}{\omega_\text{max}} = 1 + \frac{\hat{\sigma} L_\text{FBG}  }{\pi N}
\end{equation*}
%
Figure~\ref{fig:uniform_spectra_varykL} shows representative amplitude reflectivity and phase spectra for uniform gratings, plotted against angular frequency. 
The gratings are centred at the common laser wavelength of 1550 nm, with $\kappa L_\text{FBG} \in {0.5, 2, 5}$ and a fixed $N = 5000$, chosen to illustrate weak, moderate, and strong coupling regimes.
Increasing $N$ (and thus $L_\text{FBG}$) results in a narrower reflection bandwidth, whereas decreasing $N$ (and thus $L_\text{FBG}$) produces a broader one, provided that $\kappa L_\text{FBG}$ remains constant.
The reflection spectrum consists of a main lobe and a series of side lobes, separated by reflection zeros that are symmetrically spaced in wavelength on either side of the main lobe.
For gratings with low $\kappa L_\text{FBG}$, such as 0.5, the main lobe has a bandwidth, defined as the interval between its reflection zeros, that is twice the width of the side lobes \cite{erdogan1997fiber}.
Evidently, increasing $\kappa L_\text{FBG}$ increases the grating's maximum reflectivity and also broadens the main-lobe bandwidth while narrowing that of the side lobes.
Additionally, the time delay is approximately constant for low reflectivities but becomes increasingly distorted as $\kappa L_\text{FBG}$ increases.
%
\begin{figure}[!t]
    \includegraphics[width=\linewidth]{Images/Uniform_varying_kL_Rtau.pdf}
    \caption{Examples of magnitude and phase of uniform FBG reflection spectra with varying dimensionless grating strength $\k L_\text{FBG} \in [0.5, 2, 5]$ and constant number of grating periods $N=5000$.}
    \label{fig:uniform_spectra_varykL}
\end{figure}
%
\par
%
Since $\kappa$ and $\hat{\sigma}$ depend only on $\lambda$ and the prescribed grating parameters, the reflected amplitude $|\rho|$ and phase $\arg(\rho)$ can be directly plotted against frequency by substituting \eqref{eq:kappa} and \eqref{eq:sigma} into \eqref{eq:uniform_rho}.
Figure~\ref{fig:uniform_spectra_varying_L_dneff} shows examples of reflection spectra of uniform FBGs plotted against frequency, with the design frequency given by
%
\begin{equation}
    \w_D = \frac{\pi c}{\Lambda n_{eff}^2}
\end{equation}
%
highlighted to demonstrate the intrinsic frequency shift in the spectrum. The reflection spectrum of a uniform grating has a maximum reflectivity
%
\begin{equation}
\label{eq:rmax}
    R \equiv |\rho_\text{max}| = \tanh{(\k L_\text{FBG})}
\end{equation}
%
centred at the Bragg frequency $\omega_\text{max}$,
%
\begin{equation}
\label{eq:wBragg}
    \w_\max = \frac{\w_D}{\left( 1 + \frac{\dnbar }{\neff}\right)}
\end{equation}
%
corresponding to the peak reflectivity.
We note that $R$ is more commonly used to denote reflected power rather than reflected amplitude; however, the present notation is adopted for clarity in later sections.
The phase at $\omega_\text{max}$ is $\sfrac{\pi}{2}$ for all uniform gratings, while the reflection zeros are symmetric about $\omega_\text{max}$. 
The first zeros on either side of the main lobe occur at $\omega_\text{max} \pm \omega_z$, where
%
\begin{equation}
\label{eq:wz}
    \wz = \w_\max \sqrt{\left( \frac{\dnbar}{2 \neff} \right)^2 + \frac{1}{N^2} }
\end{equation}
%
and the phase of the reflection spectrum shifts by $2\pi$ between these zeros.
Outside the main lobe, the reflectivity peaks of the side lobes decay exponentially, with a $\pi$ phase change across each lobe.
%
\begin{figure}[!t]
    \includegraphics[width=\linewidth]{Images/Uniform_varying_L_dneff.pdf}
    \caption{Examples of the magnitude and group delay of uniform FBG reflection spectra, illustrating the effect of varying $\dnbar$ and $L_\text{FBG}$. 
    The nominal case (black curves) corresponds to $\dnbar = 5\e{-5}\neff$ and $L_\text{FBG} = 2.64,\text{mm}$; in (a) the grating length is doubled to $L_\text{FBG} = 5.28,\text{mm}$, and in (b) the index change is doubled to $\dnbar = 1\e{-4}\neff$.}
    \label{fig:uniform_varying_L_dneff}
\end{figure}
%
\par
%
Figure~\ref{fig:uniform_varying_L_dneff}(a) shows that doubling $L_\text{FBG}$ increases $R$ because more grating periods contribute to reflection, reducing transmission. 
At the same time, the bandwidth of each lobe is halved, while the offset from the design frequency remains unchanged. 
In contrast, doubling $\dnbar$, as shown in (b), again increases $R$, but now the offset from the design frequency increases while the bandwidth remains unchanged. 
Since these two parameters govern the three key spectral features—offset, maximum reflectivity, and bandwidth—one cannot vary a single feature independently. 
Instead, compensation requires adjusting the grating period $\Lambda$, which shifts $\w_\max$ while leaving $\wz$ and $R$ essentially unchanged. 
This holds because laser centre frequencies are in the THz range, whereas the frequency offset is at most in GHz, so $\w_\max}/\w_D = \Lambda_D/\Lambda_{\max} \approx 1$.
Using this approximation, together with \eqref{eq:wBragg} and \eqref{eq:wz}, $\dnbar$, $L_\text{FBG}$, and $\Lambda$ can be calculated sequentially.
%
\begin{align}
\label{eq:spec2phys}
    \dnbar &\approx \frac{2\wz}{\w_c} \frac{\neff}{\sqrt{1 + \left(\frac{\pi}{\arctanh{(R)}} \right)^2}}
    \\
    \Lambda &= \frac{\pi c}{\w_c \neff (\neff +\dnbar)}
    \\
    L &= \frac{\Lambda}{\sqrt{\left( \frac{\wz}{\w_c} \right)^2 - \left( \frac{\dnbar}{2\neff} \right)^2}}
\end{align}
%
For example, if a uniform grating with a spectral response corresponding to $\w_c = 1.216\e{15}\; \text{rad s}^{-1}$, $\wz = 1\e{10}\; \text{rad s}^{-1}$, and $R = 0.5$ is desired, 
\eqref{eq:spec2phys} provides grating parameters $\dnbar= 4.2111838\e{-6}$, $\Lambda = 3.6494583\e{-7}\,\text{m}$, $L = 0.0444578955\,\text{m}$, 
which gives excellent agreement to the desired spectral response as shown in Figure~\ref{fig:spec2phys}.
%
%
\section*{FBG distributed feedback}
\label{sec:FBG_feedback}
%
Given the significant spectral advantages of FBGs for FOF and the straight-forward integration of FBGs into fiber optic semiconductor laser systems, 
investigations into their influence on the dynamics of external feedback semiconductor laser systems is of great interest. 
A sketch of the laser system under external feedback from an FBG is shown in Figure~\ref{fig:FBGF}. 
As demonstrated in the previous section, the reflectivity spectrum of FBGs can be rather complex. 
As an FBG in essence acts as a filter, the term $F(t)$ will be given by \eqref{eq:FOF} with $\rho(\w) = \rho_\text{Bragg}(\w)$. 
This term can alternatively be written as a convolution in the time domain,
%
\begin{equation}
    \label{eq:convolution}
     F(t) = e^{-i C_p} \tilde{\rho}_\text{Bragg}(t) \otimes E(t-\tau)
\end{equation}
%
where $\tilde{\rho}_\text{Bragg}(t)$ is the impulse response of the FBG with respect to the Bragg resonance frequency. 
Analytic expressions do not exist for the impulse response, even for simple gratings, and must therefore be calculated numerically through fast Fourier transforms (FFTs), for example. 
The requirement of numerically calculating $F(t)$ limits the analysis to numerical integration of solutions for $(E(t),N(t))$, and calculating properties of resulting time series, 
such as maximal Lyapunov exponents (MLEs) or spectral characteristics such as signal dispersion. 
Despite the obvious computational and analytical difficulties associated with this feedback term, 
research has been conducted into uniform FBG feedback using the convolution representation for $F(t)$ \cite{li2012distributed, li2015chaotic, li2020stable, jiang2021characterizing, skenderas2021feedback, skenderas2024impact}. 
In several studies, an expression for $\rho(\w)$ separates the reflection spectrum and detuning, allowing the detuning to be varied continuously while keeping the reflectivity spectrum shape constant. 
In this case, the reflected signal has the form,
%
\begin{equation*}
    F(t) = \eta e^{-i C_p} [\tilde{\rho}_0(t) e^{i \wB t}] \otimes E(t-\tau)
\end{equation*}
%
where $\tilde{\rho}_0$ is centred at the laser free-running frequency, while the detuning $\wB$ is an independent parameter. 
Although this form for the reflectivity distribution allows one to vary a single feature of the reflectivity distribution, as discussed in \ref{subsec:FBG_feedback}, the detuning and distribution shape intrinsically depend on each other, 
meaning that all grating parameters $\dnbar, \Lambda, L$ must be simultaneously adjusted in order to continuously detune over a constant distribution shape \cite{skenderas2024impact}. 
These parameters can be calculated for example through \eqref{eq:spec2phys}. 
Similarly, the distribution width and maximum reflectivity (occurring at $\w_c$) can only be independently varied through simultaneously varying all grating parameters.
%
\par
%
As numerical investigations only allow limited insights into the underlying dynamics of FBG feedback, initial numerical investigations focused on the potential of FBG feedback to produce high-quality chaotic signals. 
This is of research interest as chaotic signals produced by lasers subject to external feedback are used in a number of applications such as high-speed optical random bit generation \cite{uchida2008fast} and chaos-based secure communication \cite{annovazzi2008secure}. 
It was demonstrated that FBG feedback is more effective than conventional mirror feedback in suppressing the time-delay signature (TDS) associated with chaos generation in semiconductor lasers. 
TDS can limit the encryption capabilities of chaotic signals generated lasers subject to external feedback, as powerful autocorrelation algorithms can use a signal's TDS to partially or fully decrypt the signal \cite{rontani2007loss}. 
The improvement in TDS suppression was generally attributed to the time-distributed reflections provided by the FBG, `spreading out' the effective time delay of the chaotic signal \cite{li2012distributed}. 
Further, it was observed that TDS suppression improves as the bandwidth of the FBG decreases. This is linked to the increase in dispersion of the reflection group delay, which plays a crucial role in the dynamics of the laser. 
Notably, the length of the FBG does not significantly affect this suppression. 
Although narrower FBG bandwidth enhances chaotic signal TDS suppression, the size of parameter regions that exhibit chaos decrease, being replaced by regions of stable period-1 periodic orbits, 
in agreement with analyses of FOF \cite{li2020stable}, although it was demonstrated that in some cases, 
chaos can be induced by FBG feedback for lower time delays than what is possible using COF. 
Further investigations showed that optimal TDS suppression is achieved when the FBG is positively detuned from the laser frequency. 
The preference for positive detuning is attributed to the red-shifting of the laser cavity due to the anti-guidance effect \cite{li2015chaotic}. 
%
%From a dynamical systems perspective, these initial numerical investigations raised interesting questions on why there is an intrinsic asymmetry about the FBG spectrum in laser stability for positive or negative detuning and whether the laser frequency 
%
\par
%
The convolution representation for $F(t)$ under FBG feedback can alternatively be written as a distributed delay term. Using the definition of the convolution,
%
\begin{align*}
    \tilde{\rho}(t) \otimes E(t-\tau)
    &= \int_{-\infty}^{\infty} \tilde{\rho}(t-s) E(s-\tau) ds \\
    &= \int_{-\infty}^{t+\tau} \tilde{\rho}(t-s) E(s-\tau) ds
\end{align*}
%
as $E(s-\tau)=0$ for $s>t+\tau$. Now, choosing the lower bound $t-T$ so that $\tilde{\rho}(s) \approx 0 \; \forall \; s>T$.
%
\begin{equation*}
    \tilde{\rho}(t) \otimes E(t-\tau) \approx \int_{t-T}^{t+\tau} \tilde{\rho}(t-s) E(s - \tau) ds
\end{equation*}
%
This equivalent expression for $F(t)$ has been used in further numerical studies on the use of chirped FBGs (CFBGs), 
which are of interest in TDS suppression due to their enhanced dispersion characteristics compared to the previously explored uniform FBGs \cite{wang2017time, wang2019key, wang2023critical, chao2020permutation}. 
An illustration of the index profile of CFBGs is given in Figure~\ref{fig:dneff}(d). 
As there are no analytic expressions for a chirped reflectivity spectrum compared to a uniform one, \eqref{eq:wave_eqs} must be solved numerically, further increasing computational complexity. 
The impulse response $\tilde{\rho}(t)$ involved in the distributed feedback is calculated through FFTs as done in previous investigations. 
Investigations into CFBG feedback demonstrated enhanced TDS compared to uniform FBG feedback, eliminating TDS without requiring amplification, simplifying system configuration.
%
\par
%
More recently, investigations have gone beyond studying chaotic signal generation but similar to the previous analyses, the convolution representation for $F(t)$, restricted computations to basic time series generation. 
\Skenderas \textit{et al.} observed that the location of the zeros of the reflectivity spectrum, can strongly influence laser stability. 
They demonstrated that these stability fluctuations are likely due the damping of relaxation oscillations (ROs) when the zeros of the FBG reflectivity spectrum is aligned with the laser's RO frequency ($\w_{RO}$) side lobes. 
These stability fluctuations were found by tracking the required feedback rate to produce a Hopf bifurcation, that is, where constant intensity emission begins to periodically fluctuate, for increasing the FBG length which in turn decreases FBG bandwidth. 
As changing FBG length changes its reflectivity, the other FBG parameters are required to be adjusted to ensure a constant reflectivity. 
Asymmetry in stability fluctuations were observed for frequency detuning relative to the Bragg wavelength, as was the case in previous studies \cite{li2012distributed}, but alternatively attributed to the frequency-dependent phase shift induced by the FBG \cite{skenderas2024impact, skenderas2021feedback}. 
This gives further indication that the observed asymmetrical behaviour with respect to detuning emerges as an intrinsic characteristic of FBG feedback. Overall, the numerical simulations reveal that FBG feedback shares many features with FOF. 
However, the precise shape, location of reflection zeros, and, most notably, the phase of the FBG introduce additional complexity. 
%
\par
%
While the representation of $F(t)$ as a convolution has been shown to provide some limited insights into FBG feedback, an alternative form for $F(t)$ has been shown to allow deeper analyses into its associated dynamics. 
The case of FBG feedback subject to strong feedback was considered in a series of papers by Naumenko \textit{et al.} \cite{naumenko2003characteristics, naumenko2004slow, besnard2002intensity}. 
The modified rate equations used in the analysis are based on a model first proposed in 1989 \cite{rong1989improved} describing strong feedback due to a plain mirror. 
They replace the feedback term $\eta e^{-i C_p} E(t-\tau)$ in the LK rate equations with the term $E(t) \ln{\left[ E_r(t) / E(t) \right]}$ where $E_r(t)$ accounts for the multiple EC reflections caused by the strong COF, 
similar to \eqref{eq:multiple_EC} by defining
%
\begin{equation*}
    E_r(t) = E(t) + \frac{R_2^2 - 1}{R_2^2} \sum_{n=1}^\infty (-R_2 R)^n e^{-i n C_p} E(t-n \tau)
\end{equation*}
%
Indeed, truncating this expression for $F(t)$ to first order reduces to single reflection feedback. Taking the Taylor expansion of the logarithm,
%
\begin{equation*}
    \begin{aligned}
        &E(t) \ln{\left[ \frac{E_r(t)}{E(t)} \right]} = \sum_{n=1}^\infty \frac{(-1)^{n-1}}{n}\left( \frac{E_r(t)}{E(t)} - 1\right)^n \\
        &\,\overset{n=1}{\approx} E(t)\left( \frac{E(t) + \frac{R_2^2 - 1}{R_2^2}(-R_2 R)e^{-i C_p} E(t - \tau) - E(t)}{E(t)} \right)\\
        &\;\;= \eta e^{-i C_p} E(t - \tau)
    \end{aligned}   
\end{equation*}
%
as desired.
Reflection due to an FBG can be modelled by modifying this expression to account for the spectral filtering $\rho_{\text{Bragg}}(\w)$ of the grating. 
Multiple reflections given by the terms $(R_2 R)^n e^{-i n C_p} E(t-n \tau)$ are now replaced by terms given by \eqref{eq:FOF}, see Appendix~\ref{sec:multiple_EC_nondim} for details. 
Through the use of Green's functions, an expression for the ECMs of the system can be derived, allowing for significantly deeper insights into the dynamics compared to the convolution method discussed previously. 
It was shown that under weak feedback, the stationary ECM states are mostly confined to the main lobe of the gratings reflectivity spectrum, while the MGM is shifted close to $\wB=0$, 
identical to the results presented by Yousefi and Lenstra in the case of FOF. 
They additionally identified `satellite' ECMs, for narrow bandwidth FBGs, separated from the central ECM ellipse by the zeros of the main lobe. 
It is shown that under strong feedback conditions that narrow filters lead to the excitation of additional solutions confined to the side lobes of the FBG frequency response. 
Although numerical integration of the presented system can be performed, and stationary states calculated, 
the complexity of $F(t)$ prevents the use of advanced bifurcation tools such as numerical continuation and stability analysis of the stationary solutions, clouding the underlying dynamics induced by the frequency-dependent FBG reflection. 
%
\par
%
The similarities in the results of Naumenko \textit{et al.} to work on FOF is fairly evident when one considers a single reflection. 
Carrying out the same first-order approximation on this feedback term yields an equivalent feedback term as used in the original FOF definition considered by Yousefi and Lenstra with $\rho(\w) = \rho_\text{Bragg}(\w)$. 
See Appendix~\ref{sec:multiple_EC_nondim} for further details. 
Therefore, it is natural to ask if there is a an approximation to $\rho_\text{Bragg}(w)$ which captures its key frequency-dependent reflection effects while enabling the feedback term $\eta F(t)$ to be reduced to DDEs which amenable to advanced bifurcation analysis.